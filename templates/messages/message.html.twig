{% extends 'layout/tracker.html.twig' %}

{% block title %}Message{% endblock %}

{% block body %}
    <div class="row small-device mt-4">
        <div class="col-12 col-lg-10 col-xl-8 mx-auto">
            <h1 class="text-center"><?php echo $data['request_data']['title']; ?></h1>

            <div class="fancy-container bx-d-sm-0">
                <!-- sender -->
                <div class="fancy-row">
                    <div class="row small-device">
                        <div class="rowhead col-12 col-sm-2 pr-sm-0 text-left-d-sm pb-d-sm-1">Sender</div>
                        <div class="col-12 col-sm-10">
                            {% if pmto.sender is null %}
                                <b>System</b>
                            {% else %}
                                <a class="r04" href="{{ path('user.profile.id', {id:pmto.sender.id}) }}"><b>{{ pmto.sender.username }}</b></a>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- sent age -->
                <div class="fancy-row">
                    <div class="row small-device">
                        <div class="rowhead col-12 col-sm-2 pr-sm-0 text-left-d-sm pb-d-sm-1">Sent</div>
                        <div class="col-12 col-sm-10">
                            {{ functions.timeago_short(pmto.message.added) }}
                        </div>
                    </div>
                </div>

                <!-- subject -->
                <div class="fancy-row">
                    <div class="row small-device">
                        <div class="rowhead col-12 col-sm-2 pr-sm-0 text-left-d-sm pb-d-sm-1">Subject</div>
                        <div class="col-12 col-sm-10">
                            <b class="navy">{{ pmto.message.subject }}</b>
                        </div>
                    </div>
                </div>

                <!-- message -->
                <div class="fancy-row">
                    <div class="row small-device">
                        <div class="rowhead col-12 col-sm-2 pr-sm-0 text-left-d-sm pb-d-sm-1">Message</div>
                        <div class="col-12 col-sm-10">
                            {% if system is not empty %}
                                {% apply markdown_to_html %}
                                    {{ pmto.message.message }}
                                {% endapply %}
                            {% else %}
                                {{ pmto.message.message|raw }}
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row small-device mt-3 mb-5">
        <div class="col-12 col-lg-10 offset-lg-1 col-xl-8 offset-xl-2">
            <div class="text-center d-flex justify-content-between px-2 px-sm-0">
                <div>
                    {% if sentbox is null and system is not null %}
                    <a class="btn no-decoration" href="{{ path('message.reply', {id:pmto.message.id})}}">Reply</a>
                    <a class="btn no-decoration" href="{{ path('message.forward', {id:pmto.message.id}) }}">Forward</a>
                    {% endif %}
                </div>
                <a class="btn no-decoration" href="{{ path('message.remove', {id:pmto.message.id}) }}">Delete</a>
            </div>
        </div>
    </div>
{% endblock %}